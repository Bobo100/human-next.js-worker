import { useEffect, useState, useMemo, useRef } from "react";
import useDetectFaceWorker from "@/hooks/use-detect-face-worker";
import _size from "lodash/size";
import _slice from "lodash/slice";
import _range from "lodash/range";
import _includes from "lodash/includes";
import _get from "lodash/get";
import _filter from "lodash/filter";
import detectFaceUtils from "@/utils/detectFaceUtils";

const relativeRect = {
  top: 828.84375,
  bottom: 2102.625,
  left: 1750.21875,
  right: 2915.71875,
};

const point = [
    [
        1603,
        1347,
        -11
    ],
    [
        1650,
        1206,
        -21
    ],
    [
        1612,
        1248,
        -11
    ],
    [
        1598,
        1041,
        -17
    ],
    [
        1657,
        1160,
        -22
    ],
    [
        1653,
        1098,
        -20
    ],
    [
        1631,
        934,
        -10
    ],
    [
        1220,
        852,
        -3
    ],
    [
        1634,
        810,
        -7
    ],
    [
        1641,
        745,
        -7
    ],
    [
        1651,
        494,
        -3
    ],
    [
        1599,
        1369,
        -10
    ],
    [
        1591,
        1391,
        -9
    ],
    [
        1582,
        1402,
        -8
    ],
    [
        1573,
        1464,
        -5
    ],
    [
        1573,
        1486,
        -6
    ],
    [
        1571,
        1516,
        -6
    ],
    [
        1565,
        1545,
        -6
    ],
    [
        1551,
        1591,
        -3
    ],
    [
        1638,
        1232,
        -19
    ],
    [
        1568,
        1221,
        -14
    ],
    [
        999,
        592,
        10
    ],
    [
        1381,
        909,
        -4
    ],
    [
        1331,
        907,
        -5
    ],
    [
        1276,
        900,
        -5
    ],
    [
        1193,
        859,
        -4
    ],
    [
        1421,
        903,
        -3
    ],
    [
        1311,
        761,
        -7
    ],
    [
        1369,
        775,
        -5
    ],
    [
        1253,
        759,
        -7
    ],
    [
        1210,
        773,
        -6
    ],
    [
        1153,
        882,
        -3
    ],
    [
        1342,
        1621,
        -2
    ],
    [
        1194,
        833,
        -3
    ],
    [
        968,
        812,
        10
    ],
    [
        1089,
        833,
        0
    ],
    [
        1327,
        1103,
        -8
    ],
    [
        1527,
        1329,
        -12
    ],
    [
        1523,
        1385,
        -10
    ],
    [
        1440,
        1337,
        -11
    ],
    [
        1385,
        1351,
        -9
    ],
    [
        1461,
        1381,
        -9
    ],
    [
        1414,
        1384,
        -7
    ],
    [
        1298,
        1431,
        -4
    ],
    [
        1605,
        1200,
        -21
    ],
    [
        1604,
        1153,
        -22
    ],
    [
        1144,
        716,
        -7
    ],
    [
        1442,
        1000,
        -7
    ],
    [
        1439,
        1155,
        -14
    ],
    [
        1432,
        1126,
        -13
    ],
    [
        1166,
        1070,
        -7
    ],
    [
        1602,
        1094,
        -20
    ],
    [
        1291,
        691,
        -10
    ],
    [
        1208,
        693,
        -9
    ],
    [
        1078,
        522,
        4
    ],
    [
        1519,
        777,
        -8
    ],
    [
        1416,
        801,
        -3
    ],
    [
        1264,
        1373,
        -4
    ],
    [
        950,
        1287,
        20
    ],
    [
        1474,
        1189,
        -12
    ],
    [
        1517,
        1213,
        -11
    ],
    [
        1318,
        1389,
        -4
    ],
    [
        1345,
        1394,
        -4
    ],
    [
        1180,
        654,
        -7
    ],
    [
        1427,
        1172,
        -12
    ],
    [
        1393,
        714,
        -10
    ],
    [
        1390,
        673,
        -10
    ],
    [
        1337,
        458,
        -5
    ],
    [
        1134,
        589,
        -2
    ],
    [
        1373,
        566,
        -7
    ],
    [
        1109,
        685,
        -4
    ],
    [
        1057,
        645,
        3
    ],
    [
        1525,
        1360,
        -11
    ],
    [
        1452,
        1363,
        -10
    ],
    [
        1400,
        1368,
        -8
    ],
    [
        1483,
        1199,
        -11
    ],
    [
        1332,
        1392,
        -4
    ],
    [
        1357,
        1418,
        -5
    ],
    [
        1351,
        1393,
        -4
    ],
    [
        1520,
        1186,
        -17
    ],
    [
        1421,
        1383,
        -7
    ],
    [
        1467,
        1386,
        -8
    ],
    [
        1522,
        1393,
        -8
    ],
    [
        1475,
        1572,
        -4
    ],
    [
        1491,
        1527,
        -7
    ],
    [
        1500,
        1499,
        -7
    ],
    [
        1509,
        1471,
        -6
    ],
    [
        1514,
        1454,
        -6
    ],
    [
        1415,
        1427,
        -5
    ],
    [
        1405,
        1433,
        -6
    ],
    [
        1390,
        1444,
        -6
    ],
    [
        1374,
        1457,
        -6
    ],
    [
        1346,
        1292,
        -9
    ],
    [
        911,
        1017,
        24
    ],
    [
        1625,
        1241,
        -14
    ],
    [
        1385,
        1415,
        -4
    ],
    [
        1373,
        1415,
        -5
    ],
    [
        1534,
        1235,
        -11
    ],
    [
        1434,
        1201,
        -9
    ],
    [
        1526,
        1225,
        -11
    ],
    [
        1385,
        1016,
        -7
    ],
    [
        1300,
        1034,
        -7
    ],
    [
        1416,
        1143,
        -11
    ],
    [
        1187,
        475,
        -1
    ],
    [
        1236,
        561,
        -5
    ],
    [
        1275,
        648,
        -9
    ],
    [
        1343,
        1482,
        -4
    ],
    [
        1513,
        712,
        -9
    ],
    [
        1505,
        589,
        -7
    ],
    [
        1486,
        467,
        -5
    ],
    [
        1224,
        883,
        -5
    ],
    [
        1095,
        903,
        -2
    ],
    [
        1446,
        892,
        -2
    ],
    [
        1152,
        785,
        -4
    ],
    [
        1485,
        979,
        -8
    ],
    [
        1486,
        1149,
        -17
    ],
    [
        1026,
        924,
        1
    ],
    [
        1136,
        945,
        -4
    ],
    [
        1209,
        975,
        -6
    ],
    [
        1313,
        983,
        -6
    ],
    [
        1385,
        975,
        -5
    ],
    [
        1439,
        962,
        -5
    ],
    [
        1577,
        936,
        -10
    ],
    [
        1025,
        1028,
        0
    ],
    [
        1110,
        768,
        -3
    ],
    [
        1610,
        1226,
        -19
    ],
    [
        1444,
        1050,
        -8
    ],
    [
        922,
        788,
        21
    ],
    [
        1482,
        946,
        -4
    ],
    [
        1402,
        1142,
        -8
    ],
    [
        1171,
        824,
        -2
    ],
    [
        1479,
        1114,
        -16
    ],
    [
        918,
        1145,
        23
    ],
    [
        1438,
        877,
        -1
    ],
    [
        1542,
        1099,
        -19
    ],
    [
        1093,
        1454,
        5
    ],
    [
        1068,
        1511,
        10
    ],
    [
        945,
        1025,
        12
    ],
    [
        1026,
        1367,
        7
    ],
    [
        1008,
        719,
        7
    ],
    [
        1317,
        1680,
        -1
    ],
    [
        1601,
        1235,
        -14
    ],
    [
        1390,
        1075,
        -8
    ],
    [
        1038,
        831,
        3
    ],
    [
        1284,
        875,
        -5
    ],
    [
        1334,
        883,
        -5
    ],
    [
        1340,
        1421,
        -5
    ],
    [
        1019,
        1130,
        1
    ],
    [
        1398,
        1778,
        2
    ],
    [
        1225,
        1667,
        5
    ],
    [
        1151,
        1600,
        7
    ],
    [
        1649,
        618,
        -5
    ],
    [
        1512,
        1804,
        3
    ],
    [
        1375,
        883,
        -4
    ],
    [
        1410,
        880,
        -3
    ],
    [
        1431,
        877,
        -1
    ],
    [
        1067,
        747,
        0
    ],
    [
        1397,
        851,
        -3
    ],
    [
        1353,
        837,
        -4
    ],
    [
        1310,
        828,
        -5
    ],
    [
        1263,
        825,
        -5
    ],
    [
        1231,
        829,
        -5
    ],
    [
        950,
        675,
        16
    ],
    [
        1247,
        865,
        -4
    ],
    [
        1607,
        1280,
        -10
    ],
    [
        1398,
        1269,
        -10
    ],
    [
        1479,
        1183,
        -13
    ],
    [
        1524,
        1272,
        -11
    ],
    [
        1628,
        870,
        -7
    ],
    [
        1164,
        1538,
        4
    ],
    [
        1236,
        1609,
        2
    ],
    [
        1416,
        1734,
        -2
    ],
    [
        1002,
        1413,
        15
    ],
    [
        1425,
        868,
        -2
    ],
    [
        1538,
        1008,
        -12
    ],
    [
        1529,
        1764,
        -1
    ],
    [
        1306,
        1728,
        3
    ],
    [
        947,
        1141,
        11
    ],
    [
        1461,
        1440,
        -6
    ],
    [
        1451,
        1452,
        -6
    ],
    [
        1438,
        1472,
        -7
    ],
    [
        1426,
        1497,
        -7
    ],
    [
        1400,
        1532,
        -5
    ],
    [
        1373,
        1387,
        -6
    ],
    [
        1357,
        1379,
        -6
    ],
    [
        1341,
        1367,
        -6
    ],
    [
        1299,
        1327,
        -7
    ],
    [
        1104,
        1171,
        -4
    ],
    [
        1532,
        955,
        -8
    ],
    [
        1493,
        850,
        -2
    ],
    [
        1455,
        847,
        -2
    ],
    [
        1383,
        1384,
        -5
    ],
    [
        1071,
        1296,
        2
    ],
    [
        1551,
        862,
        -6
    ],
    [
        1369,
        1570,
        -3
    ],
    [
        1645,
        1043,
        -17
    ],
    [
        1587,
        993,
        -13
    ],
    [
        1638,
        991,
        -13
    ],
    [
        1490,
        1073,
        -12
    ],
    [
        1540,
        1705,
        -2
    ],
    [
        1545,
        1641,
        -2
    ],
    [
        1458,
        1618,
        -3
    ],
    [
        1248,
        1443,
        -2
    ],
    [
        1353,
        1173,
        -8
    ],
    [
        1300,
        1511,
        -3
    ],
    [
        1240,
        1151,
        -8
    ],
    [
        1303,
        1218,
        -8
    ],
    [
        1180,
        1225,
        -6
    ],
    [
        1438,
        1676,
        -3
    ],
    [
        1444,
        1089,
        -10
    ],
    [
        1195,
        1480,
        0
    ],
    [
        1265,
        1554,
        0
    ],
    [
        1213,
        1369,
        -3
    ],
    [
        1020,
        1221,
        3
    ],
    [
        1138,
        1369,
        -1
    ],
    [
        969,
        1255,
        11
    ],
    [
        1253,
        1279,
        -7
    ],
    [
        1490,
        1029,
        -10
    ],
    [
        1504,
        1175,
        -18
    ],
    [
        1456,
        1175,
        -14
    ],
    [
        1545,
        1150,
        -20
    ],
    [
        1459,
        796,
        -4
    ],
    [
        1380,
        752,
        -6
    ],
    [
        1306,
        733,
        -8
    ],
    [
        1237,
        732,
        -8
    ],
    [
        1184,
        749,
        -7
    ],
    [
        1138,
        830,
        -2
    ],
    [
        951,
        916,
        11
    ],
    [
        1185,
        908,
        -4
    ],
    [
        1245,
        932,
        -5
    ],
    [
        1318,
        942,
        -5
    ],
    [
        1384,
        939,
        -4
    ],
    [
        1432,
        931,
        -3
    ],
    [
        1466,
        922,
        -3
    ],
    [
        914,
        900,
        24
    ],
    [
        1450,
        1184,
        -12
    ],
    [
        1545,
        1053,
        -15
    ],
    [
        1558,
        1188,
        -20
    ],
    [
        1573,
        1215,
        -18
    ],
    [
        1548,
        1195,
        -18
    ],
    [
        1458,
        1200,
        -11
    ],
    [
        1589,
        1221,
        -19
    ],
    [
        1581,
        1230,
        -14
    ],
    [
        1463,
        880,
        -1
    ],
    [
        1494,
        901,
        -2
    ],
    [
        1517,
        916,
        -5
    ],
    [
        1211,
        831,
        -4
    ],
    [
        1179,
        793,
        -4
    ],
    [
        1684,
        1054,
        -14
    ],
    [
        1924,
        960,
        13
    ],
    [
        1676,
        1236,
        -13
    ],
    [
        2036,
        760,
        36
    ],
    [
        1788,
        969,
        6
    ],
    [
        1831,
        980,
        8
    ],
    [
        1873,
        987,
        10
    ],
    [
        1934,
        972,
        14
    ],
    [
        1758,
        954,
        6
    ],
    [
        1882,
        859,
        7
    ],
    [
        1830,
        856,
        5
    ],
    [
        1927,
        872,
        9
    ],
    [
        1952,
        894,
        11
    ],
    [
        1953,
        997,
        17
    ],
    [
        1706,
        1652,
        6
    ],
    [
        1942,
        951,
        15
    ],
    [
        2019,
        963,
        37
    ],
    [
        1990,
        964,
        22
    ],
    [
        1835,
        1173,
        3
    ],
    [
        1670,
        1348,
        -9
    ],
    [
        1645,
        1400,
        -7
    ],
    [
        1727,
        1373,
        -5
    ],
    [
        1751,
        1398,
        -1
    ],
    [
        1686,
        1409,
        -4
    ],
    [
        1712,
        1421,
        -1
    ],
    [
        1773,
        1487,
        7
    ],
    [
        1689,
        1211,
        -19
    ],
    [
        1702,
        1167,
        -20
    ],
    [
        2003,
        853,
        14
    ],
    [
        1751,
        1045,
        0
    ],
    [
        1782,
        1201,
        -7
    ],
    [
        1782,
        1174,
        -6
    ],
    [
        1944,
        1171,
        11
    ],
    [
        1695,
        1108,
        -18
    ],
    [
        1927,
        802,
        4
    ],
    [
        1978,
        821,
        9
    ],
    [
        2024,
        680,
        28
    ],
    [
        1737,
        817,
        -3
    ],
    [
        1784,
        866,
        6
    ],
    [
        1812,
        1440,
        9
    ],
    [
        1902,
        1393,
        44
    ],
    [
        1742,
        1225,
        -7
    ],
    [
        1701,
        1240,
        -9
    ],
    [
        1765,
        1446,
        7
    ],
    [
        1739,
        1443,
        6
    ],
    [
        1995,
        789,
        12
    ],
    [
        1774,
        1219,
        -6
    ],
    [
        1851,
        796,
        0
    ],
    [
        1863,
        758,
        0
    ],
    [
        1901,
        560,
        9
    ],
    [
        2010,
        733,
        19
    ],
    [
        1878,
        654,
        4
    ],
    [
        2020,
        830,
        18
    ],
    [
        2028,
        798,
        26
    ],
    [
        1660,
        1377,
        -8
    ],
    [
        1707,
        1395,
        -5
    ],
    [
        1733,
        1410,
        -1
    ],
    [
        1728,
        1233,
        -7
    ],
    [
        1752,
        1445,
        6
    ],
    [
        1735,
        1465,
        4
    ],
    [
        1732,
        1439,
        5
    ],
    [
        1729,
        1213,
        -12
    ],
    [
        1695,
        1418,
        0
    ],
    [
        1669,
        1412,
        -3
    ],
    [
        1630,
        1408,
        -6
    ],
    [
        1618,
        1587,
        -2
    ],
    [
        1630,
        1544,
        -4
    ],
    [
        1632,
        1516,
        -5
    ],
    [
        1628,
        1486,
        -4
    ],
    [
        1622,
        1467,
        -3
    ],
    [
        1688,
        1460,
        1
    ],
    [
        1698,
        1469,
        1
    ],
    [
        1712,
        1485,
        0
    ],
    [
        1722,
        1501,
        1
    ],
    [
        1796,
        1350,
        1
    ],
    [
        1956,
        1153,
        51
    ],
    [
        1706,
        1454,
        4
    ],
    [
        1720,
        1458,
        4
    ],
    [
        1682,
        1258,
        -9
    ],
    [
        1753,
        1248,
        -4
    ],
    [
        1691,
        1250,
        -9
    ],
    [
        1791,
        1073,
        3
    ],
    [
        1857,
        1110,
        5
    ],
    [
        1781,
        1194,
        -4
    ],
    [
        1984,
        614,
        18
    ],
    [
        1962,
        685,
        12
    ],
    [
        1943,
        764,
        6
    ],
    [
        1732,
        1527,
        4
    ],
    [
        1758,
        758,
        -4
    ],
    [
        1776,
        637,
        -1
    ],
    [
        1795,
        523,
        2
    ],
    [
        1911,
        985,
        12
    ],
    [
        1983,
        1026,
        20
    ],
    [
        1741,
        941,
        6
    ],
    [
        1978,
        913,
        16
    ],
    [
        1724,
        1015,
        -2
    ],
    [
        1763,
        1186,
        -12
    ],
    [
        2012,
        1058,
        25
    ],
    [
        1964,
        1058,
        16
    ],
    [
        1920,
        1071,
        11
    ],
    [
        1843,
        1056,
        7
    ],
    [
        1786,
        1032,
        5
    ],
    [
        1747,
        1007,
        3
    ],
    [
        1675,
        952,
        -7
    ],
    [
        2009,
        1156,
        24
    ],
    [
        2001,
        903,
        18
    ],
    [
        1663,
        1233,
        -18
    ],
    [
        1754,
        1095,
        -1
    ],
    [
        1997,
        946,
        49
    ],
    [
        1718,
        982,
        1
    ],
    [
        1778,
        1194,
        0
    ],
    [
        1956,
        947,
        16
    ],
    [
        1762,
        1153,
        -10
    ],
    [
        1935,
        1268,
        48
    ],
    [
        1745,
        927,
        7
    ],
    [
        1730,
        1126,
        -15
    ],
    [
        1864,
        1530,
        23
    ],
    [
        1834,
        1583,
        29
    ],
    [
        2003,
        1162,
        38
    ],
    [
        1909,
        1459,
        28
    ],
    [
        2026,
        874,
        33
    ],
    [
        1706,
        1713,
        8
    ],
    [
        1646,
        1242,
        -13
    ],
    [
        1786,
        1131,
        1
    ],
    [
        2008,
        970,
        26
    ],
    [
        1876,
        964,
        10
    ],
    [
        1835,
        958,
        9
    ],
    [
        1747,
        1472,
        5
    ],
    [
        1993,
        1250,
        25
    ],
    [
        1615,
        1796,
        6
    ],
    [
        1741,
        1711,
        17
    ],
    [
        1785,
        1657,
        22
    ],
    [
        1800,
        947,
        7
    ],
    [
        1770,
        935,
        7
    ],
    [
        1752,
        929,
        7
    ],
    [
        2017,
        891,
        23
    ],
    [
        1779,
        915,
        7
    ],
    [
        1817,
        914,
        7
    ],
    [
        1857,
        918,
        8
    ],
    [
        1896,
        926,
        10
    ],
    [
        1920,
        938,
        12
    ],
    [
        2026,
        843,
        44
    ],
    [
        1902,
        963,
        12
    ],
    [
        1770,
        1320,
        -3
    ],
    [
        1747,
        1219,
        -9
    ],
    [
        1681,
        1294,
        -8
    ],
    [
        1813,
        1598,
        18
    ],
    [
        1761,
        1655,
        13
    ],
    [
        1630,
        1752,
        3
    ],
    [
        1868,
        1500,
        36
    ],
    [
        1757,
        923,
        7
    ],
    [
        1707,
        1033,
        -8
    ],
    [
        1687,
        1761,
        11
    ],
    [
        1983,
        1267,
        37
    ],
    [
        1660,
        1464,
        -1
    ],
    [
        1670,
        1479,
        -1
    ],
    [
        1678,
        1502,
        -2
    ],
    [
        1683,
        1529,
        -1
    ],
    [
        1683,
        1564,
        1
    ],
    [
        1728,
        1432,
        3
    ],
    [
        1747,
        1428,
        3
    ],
    [
        1764,
        1421,
        4
    ],
    [
        1810,
        1391,
        5
    ],
    [
        1954,
        1274,
        16
    ],
    [
        1699,
        981,
        -4
    ],
    [
        1717,
        888,
        3
    ],
    [
        1741,
        896,
        6
    ],
    [
        1715,
        1424,
        3
    ],
    [
        1928,
        1391,
        21
    ],
    [
        1686,
        885,
        -3
    ],
    [
        1693,
        1601,
        4
    ],
    [
        1680,
        1006,
        -11
    ],
    [
        1740,
        1108,
        -7
    ],
    [
        1623,
        1633,
        0
    ],
    [
        1802,
        1503,
        10
    ],
    [
        1807,
        1235,
        1
    ],
    [
        1752,
        1558,
        7
    ],
    [
        1889,
        1234,
        6
    ],
    [
        1834,
        1287,
        4
    ],
    [
        1906,
        1312,
        10
    ],
    [
        1632,
        1692,
        1
    ],
    [
        1760,
        1134,
        -4
    ],
    [
        1821,
        1542,
        14
    ],
    [
        1763,
        1600,
        10
    ],
    [
        1845,
        1442,
        11
    ],
    [
        1967,
        1332,
        25
    ],
    [
        1883,
        1450,
        16
    ],
    [
        1952,
        1365,
        34
    ],
    [
        1850,
        1351,
        7
    ],
    [
        1730,
        1064,
        -4
    ],
    [
        1747,
        1206,
        -13
    ],
    [
        1767,
        1217,
        -9
    ],
    [
        1736,
        1175,
        -16
    ],
    [
        1761,
        850,
        3
    ],
    [
        1838,
        832,
        4
    ],
    [
        1902,
        835,
        6
    ],
    [
        1951,
        851,
        9
    ],
    [
        1977,
        878,
        12
    ],
    [
        1968,
        956,
        18
    ],
    [
        2014,
        1062,
        38
    ],
    [
        1934,
        1016,
        14
    ],
    [
        1892,
        1023,
        11
    ],
    [
        1837,
        1016,
        8
    ],
    [
        1784,
        997,
        6
    ],
    [
        1748,
        979,
        5
    ],
    [
        1724,
        963,
        4
    ],
    [
        1971,
        1047,
        51
    ],
    [
        1760,
        1227,
        -7
    ],
    [
        1716,
        1078,
        -11
    ],
    [
        1720,
        1209,
        -17
    ],
    [
        1684,
        1230,
        -16
    ],
    [
        1714,
        1215,
        -15
    ],
    [
        1743,
        1240,
        -6
    ],
    [
        1677,
        1233,
        -17
    ],
    [
        1663,
        1242,
        -13
    ],
    [
        1729,
        925,
        6
    ],
    [
        1705,
        936,
        3
    ],
    [
        1697,
        946,
        -1
    ],
    [
        1933,
        946,
        13
    ],
    [
        1963,
        918,
        14
    ]
]

const rejectRect = [
  // {
  //   top: 142.51188051595383,
  //   bottom: 440.74405974202307,
  //   left: 231.49490835030548,
  //   right: 507.4813306177868,
  // },
];

export default function DrawComponent() {
  const canvasRef = useRef(null);
  const [imageSrc, setImageSrc] = useState(null);

  useEffect(() => {
    if (!imageSrc) return;
    const canvas = canvasRef.current;
    const ctx = canvas.getContext("2d");
    const image = new Image();
    image.src = imageSrc;

    image.onload = () => {
      // 设置 canvas 大小与图片一致
      canvas.width = image.width;
      canvas.height = image.height;

      // 在 canvas 上绘制图像
      ctx.drawImage(image, 0, 0);

      // 设置矩形的样式
      ctx.strokeStyle = "red"; // 矩形边框颜色
      ctx.lineWidth = 2; // 矩形边框宽度

      // 绘制相对矩形
      const { top, bottom, left, right } = relativeRect;
      const rectWidth = right - left;
      const rectHeight = bottom - top;
      ctx.strokeRect(left, top, rectWidth, rectHeight);

      // rejectRect
      _filter(rejectRect, (rect) => {
        const { top, bottom, left, right } = rect;
        const rectWidth = right - left;
        const rectHeight = bottom - top;
        // 改用藍色
        ctx.strokeStyle = "blue";
        ctx.strokeRect(left, top, rectWidth, rectHeight);
      });

      // // 也把人脸关键点绘制出来
      const faceMesh = point.map(([x, y]) => [x, y]);
      faceMesh.forEach(([x, y]) => {
        ctx.beginPath();
        ctx.arc(x, y, 2, 0, 2 * Math.PI);
        ctx.fillStyle = "green";
        ctx.fill();
      });
      console.log("detectFaceUtils", detectFaceUtils);
      const faceRect = detectFaceUtils.calculateBoxPoints(faceMesh);
      console.log("faceRect", faceRect);
      const { topLeft, topRight, bottomLeft, bottomRight } = faceRect;
      ctx.strokeStyle = "green";
      // 然後化成一個矩形
      const faceRectWidth = topRight.x - topLeft.x;
      const faceRectHeight = bottomLeft.y - topLeft.y;
      ctx.strokeRect(topLeft.x, topLeft.y, faceRectWidth, faceRectHeight);
    };
  }, [imageSrc, relativeRect]);

  const handleFileChange = (e) => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = (e) => {
      setImageSrc(e.target.result);
    };
    reader.readAsDataURL(file);
  };

  return (
    <div>
      <input type="file" onChange={handleFileChange} />
      <canvas ref={canvasRef}></canvas>
    </div>
  );
}
